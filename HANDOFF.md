# CO+ Study ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é€£æº å¼•ãç¶™ããƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

> ä½œæˆæ—¥: 2025-12-25
> ä½œæˆè€…: AI Assistant
> ç›®çš„: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå¼•ãç¶™ãã®ãŸã‚ã®å®Œå…¨ã‚¬ã‚¤ãƒ‰

---

## ğŸ“‹ ç›®æ¬¡

1. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦](#1-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦)
2. [å¿…èª­ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](#2-å¿…èª­ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ)
3. [ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹](#3-ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹)
4. [ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ](#4-ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ )
5. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#5-æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
6. [èªè¨¼è¨­è¨ˆ](#6-èªè¨¼è¨­è¨ˆ)
7. [ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ](#7-ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ)
8. [ãƒ•ãƒƒã‚¯ä¸€è¦§](#8-ãƒ•ãƒƒã‚¯ä¸€è¦§)
9. [æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå„ªå…ˆåº¦é †ï¼‰](#9-æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å„ªå…ˆåº¦é †)
10. [æ³¨æ„äº‹é …ãƒ»è½ã¨ã—ç©´](#10-æ³¨æ„äº‹é …è½ã¨ã—ç©´)
11. [é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#11-é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
12. [ã‚ˆãã‚ã‚‹è³ªå•](#12-ã‚ˆãã‚ã‚‹è³ªå•)

---

## 1. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**CO+ Study** ã¯ã€å­¦ç¿’æ„æ¬²ã®ã‚ã‚‹å°ä¸­å­¦ç”Ÿã‚’é«˜å°‚ç”Ÿãƒ¡ãƒ³ã‚¿ãƒ¼ãŒæ”¯æ´ã™ã‚‹å­¦ç¿’è¨˜éŒ²ãƒ»ç›¸è«‡Webã‚¢ãƒ—ãƒªã€‚

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«

| ãƒ­ãƒ¼ãƒ« | å¯¾è±¡ | ä¸»ãªæ©Ÿèƒ½ |
|--------|------|----------|
| ç”Ÿå¾’ (`student`) | å°ä¸­å­¦ç”Ÿ | æ—¥å ±ä½œæˆã€ãƒãƒ£ãƒƒãƒˆç›¸è«‡ã€å®Ÿç¸¾é–²è¦§ã€ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆå›ç­” |
| ãƒ¡ãƒ³ã‚¿ãƒ¼ (`mentor`) | é«˜å°‚ç”Ÿ | æ—¥å ±ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€ãƒãƒ£ãƒƒãƒˆå¯¾å¿œã€ãŠçŸ¥ã‚‰ã›é…ä¿¡ |
| ç®¡ç†è€… (`admin`) | é‹å–¶è€… | ãƒ¡ãƒ³ã‚¿ãƒ¼ç®¡ç†ã€ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆä½œæˆã€å…¨æ©Ÿèƒ½ã‚¢ã‚¯ã‚»ã‚¹ |

### ä¸»è¦æ©Ÿèƒ½

- **å­¦ç¿’æ—¥å ±**: SNSé¢¨ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã§å­¦ç¿’è¨˜éŒ²
- **ç›¸è«‡ãƒãƒ£ãƒƒãƒˆ**: ãƒ¡ãƒ³ã‚¿ãƒ¼ã¨ã®1å¯¾1ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ£ãƒƒãƒˆ
- **å®Ÿç¸¾**: ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã€ãƒãƒƒã‚¸ã€é€£ç¶šæ—¥æ•°è¡¨ç¤º
- **ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ**: é‹å–¶ã‹ã‚‰ã®èª¿æŸ»åé›†
- **ãŠçŸ¥ã‚‰ã›**: é‹å–¶ã‹ã‚‰ã®é€šçŸ¥é…ä¿¡

---

## 2. å¿…èª­ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### æœ€é‡è¦ï¼ˆå¿…ãšå…¨æ–‡èª­ã‚€ã“ã¨ï¼‰

| ãƒ•ã‚¡ã‚¤ãƒ« | å†…å®¹ | è¡Œæ•° |
|---------|------|------|
| `project/decisions/005-backend-integration-preparation.md` | **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é€£æºã®å…¨è¨­è¨ˆ** (SSoT) | 705è¡Œ |
| `specs/features/auth.md` | èªè¨¼ãƒ»ç™»éŒ²ãƒ•ãƒ­ãƒ¼ä»•æ§˜ | 117è¡Œ |

### æ©Ÿèƒ½åˆ¥ä»•æ§˜æ›¸

| ãƒ•ã‚¡ã‚¤ãƒ« | æ©Ÿèƒ½ |
|---------|------|
| `specs/features/diary.md` | å­¦ç¿’æ—¥å ± |
| `specs/features/chat.md` | ç›¸è«‡ãƒãƒ£ãƒƒãƒˆ |
| `specs/features/archive.md` | å®Ÿç¸¾ï¼ˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ»ãƒãƒƒã‚¸ï¼‰ |
| `specs/features/survey.md` | ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ |
| `specs/features/notification.md` | ãŠçŸ¥ã‚‰ã› |
| `specs/features/home.md` | ãƒ›ãƒ¼ãƒ ç”»é¢ |
| `specs/features/tutorial.md` | ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ« |
| `specs/features/mentor.md` | ãƒ¡ãƒ³ã‚¿ãƒ¼ç®¡ç† |

### ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

| ãƒ•ã‚¡ã‚¤ãƒ« | å†…å®¹ |
|---------|------|
| `project/decisions/` | å…¨ADRï¼ˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ±ºå®šè¨˜éŒ²ï¼‰ |
| `specs/overview.md` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ |
| `specs/README.md` | specsæ§‹é€ èª¬æ˜ |

---

## 3. ç¾åœ¨ã®å®Ÿè£…çŠ¶æ…‹

### âœ… å®Œäº†æ¸ˆã¿

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰åŸºç›¤
- [x] React 18 + Vite + TypeScript ç’°å¢ƒæ§‹ç¯‰
- [x] å…¨ãƒšãƒ¼ã‚¸UIå®Ÿè£…ï¼ˆç”Ÿå¾’ãƒ»ãƒ¡ãƒ³ã‚¿ãƒ¼ä¸¡ç”»é¢ï¼‰
- [x] ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹å‹•ä½œç¢ºèª
- [x] CSS Modules ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é€£æºåŸºç›¤
- [x] `@supabase/supabase-js` ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [x] `@tanstack/react-query` ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [x] Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šï¼ˆ`lib/supabase.ts`ï¼‰
- [x] React Queryè¨­å®šï¼ˆ`lib/queryClient.ts`ï¼‰
- [x] èªè¨¼ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ï¼ˆ`lib/auth/AuthProvider.tsx`ï¼‰
- [x] å…¨ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒƒã‚¯ä½œæˆï¼ˆ7ç¨®é¡ï¼‰
- [x] `App.tsx` ã«Providerçµ±åˆ

#### SQLãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
- [x] `001_initial_schema.sql` - å…¨13ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‹ENUM
- [x] `002_triggers.sql` - updated_atè‡ªå‹•æ›´æ–°ã€profilesè‡ªå‹•ä½œæˆ
- [x] `003_rls_policies.sql` - å…¨ãƒ†ãƒ¼ãƒ–ãƒ«RLS
- [x] `004_seed_data.sql` - ãƒãƒƒã‚¸å®šç¾©15ä»¶
- [x] `005_storage.sql` - Storageãƒã‚±ãƒƒãƒˆè¨­å®š

#### P0: èªè¨¼é€£æº âœ…ï¼ˆ2025-12-25 å®Œäº†ï¼‰
- [x] Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆãƒ»ãƒªãƒ³ã‚¯æ¸ˆã¿
- [x] `.env.local` è¨­å®šæ¸ˆã¿
- [x] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œæ¸ˆã¿ï¼ˆsupabase db pushï¼‰
- [x] `LoginPage.tsx` ã§ `signInAnonymously()` å‘¼ã³å‡ºã—å®Ÿè£…
- [x] `RegisterPage.tsx` ã§ `updateProfile()` å‘¼ã³å‡ºã—å®Ÿè£…
- [x] `ProtectedRoute` ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆä½œæˆ
- [x] ç”Ÿå¾’ãƒ»ãƒ¡ãƒ³ã‚¿ãƒ¼ä¸¡æ–¹ã®ãƒ«ãƒ¼ãƒˆã‚’ `ProtectedRoute` ã§ä¿è­·
- [x] ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³è¿½åŠ ï¼ˆç”Ÿå¾’ãƒ»ãƒ¡ãƒ³ã‚¿ãƒ¼ä¸¡æ–¹ï¼‰

### â³ æœªå®Œäº†

#### P1: ãƒšãƒ¼ã‚¸åˆ¥ãƒ•ãƒƒã‚¯çµ±åˆ âœ…ï¼ˆ2025-12-25 å®Œäº†ï¼‰
- [x] DiaryPage ã§ãƒ•ãƒƒã‚¯ä½¿ç”¨
- [x] ChatPage ã§ãƒ•ãƒƒã‚¯ä½¿ç”¨
- [x] ArchivePage ã§ãƒ•ãƒƒã‚¯ä½¿ç”¨
- [x] SurveyPage ã§ãƒ•ãƒƒã‚¯ä½¿ç”¨
- [x] NotificationPage ã§ãƒ•ãƒƒã‚¯ä½¿ç”¨
- [x] Header ã§æœªèª­æ•°è¡¨ç¤º
- [x] ç”Ÿå¾’å´ å…¨ãƒšãƒ¼ã‚¸çµ±åˆå®Œäº†
- [x] ãƒ¡ãƒ³ã‚¿ãƒ¼å´ å…¨ãƒšãƒ¼ã‚¸çµ±åˆå®Œäº†
  - StudentListPage / StudentDetailPage
  - SurveyListPage / SurveyCreatePage / SurveyResultsPage  
  - NotificationListPage / NotificationManagePage
  - DashboardPage / ChatPage
  - MentorHeader / MentorSidebar / MentorProfileEditPage

#### P2: æ®‹å¯¾å¿œé …ç›®
- [ ] HomePage ã® RecentActivityTimelineï¼ˆactivitiesãƒ†ãƒ¼ãƒ–ãƒ«ãŒæœªå®šç¾©ã®ãŸã‚ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã®ã¾ã¾ï¼‰

#### P3: Edge Functions
- [ ] ãƒãƒƒã‚¸åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯
- [ ] é€£ç¶šæ—¥æ•°è¨ˆç®—Cron
- [ ] ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

---

## 4. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
co_plus_study/
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ App.tsx              # ãƒ«ãƒ¼ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆProviderçµ±åˆæ¸ˆï¼‰
â”‚   â”‚   â”œâ”€â”€ router.tsx           # React Routerè¨­å®š
â”‚   â”‚   â”œâ”€â”€ lib/                  # â˜… ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é€£æºã‚³ã‚¢
â”‚   â”‚   â”‚   â”œâ”€â”€ supabase.ts      # Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ queryClient.ts   # React Queryè¨­å®š
â”‚   â”‚   â”‚   â”œâ”€â”€ database.types.ts # DBå‹å®šç¾©
â”‚   â”‚   â”‚   â”œâ”€â”€ index.ts         # ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AuthProvider.tsx  # èªè¨¼Context
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â”‚   â””â”€â”€ hooks/           # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒƒã‚¯
â”‚   â”‚   â”‚       â”œâ”€â”€ useCurrentUser.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ useDiary.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ useChat.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ useNotifications.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ useSurveys.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ useBadges.ts
â”‚   â”‚   â”‚       â”œâ”€â”€ useCalendar.ts
â”‚   â”‚   â”‚       â””â”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ features/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/            # èªè¨¼é–¢é€£ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ student/     # ç”Ÿå¾’ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ç™»éŒ²
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ mentor/      # ãƒ¡ãƒ³ã‚¿ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³
â”‚   â”‚   â”‚   â”œâ”€â”€ student/         # ç”Ÿå¾’æ©Ÿèƒ½
â”‚   â”‚   â”‚   â””â”€â”€ mentor/          # ãƒ¡ãƒ³ã‚¿ãƒ¼æ©Ÿèƒ½
â”‚   â”‚   â””â”€â”€ shared/
â”‚   â”‚       â”œâ”€â”€ types/           # å…±é€šå‹å®šç¾©
â”‚   â”‚       â””â”€â”€ components/      # å…±é€šã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ .env.example             # ç’°å¢ƒå¤‰æ•°ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
â”‚   â”œâ”€â”€ vite.config.ts           # @/lib ã‚¨ã‚¤ãƒªã‚¢ã‚¹è¨­å®šæ¸ˆ
â”‚   â””â”€â”€ tsconfig.app.json        # ãƒ‘ã‚¹è¨­å®šæ¸ˆ
â”œâ”€â”€ supabase/
â”‚   â””â”€â”€ migrations/              # SQLãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”‚       â”œâ”€â”€ 001_initial_schema.sql
â”‚       â”œâ”€â”€ 002_triggers.sql
â”‚       â”œâ”€â”€ 003_rls_policies.sql
â”‚       â”œâ”€â”€ 004_seed_data.sql
â”‚       â””â”€â”€ 005_storage.sql
â”œâ”€â”€ specs/
â”‚   â””â”€â”€ features/                # æ©Ÿèƒ½ä»•æ§˜æ›¸
â””â”€â”€ project/
    â””â”€â”€ decisions/               # ADR
        â””â”€â”€ 005-backend-integration-preparation.md  # â˜…æœ€é‡è¦
```

---

## 5. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| å±¤ | æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ |
|-----|------|-----------|
| Frontend | React | 18.x |
| Build | Vite | æœ€æ–° |
| è¨€èª | TypeScript | 5.x |
| State | @tanstack/react-query | 5.x |
| Backend | Supabase | - |
| DB | PostgreSQL + RLS | - |
| Auth | Supabase Auth | åŒ¿åâ†’OAuthâ†’Email |
| Realtime | Supabase Realtime | WebSocket |
| Storage | Supabase Storage | avatars, chat-images |
| Styling | CSS Modules | - |

---

## 6. èªè¨¼è¨­è¨ˆ

### æ®µéšçš„èªè¨¼ãƒ¢ãƒ‡ãƒ«

```
Phase 1: åŒ¿åèªè¨¼
    â†“ ãƒªãƒ³ã‚¯
Phase 2: Google OAuth
    â†“ ãƒªãƒ³ã‚¯
Phase 3: Email/Password
```

### å®Ÿè£…æ¸ˆã¿API

```typescript
// lib/auth/AuthProvider.tsx ã‹ã‚‰åˆ©ç”¨å¯èƒ½

const { 
  user,              // Supabase Auth User
  session,           // Session
  profile,           // profiles ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ¬ã‚³ãƒ¼ãƒ‰
  isLoading,         // åˆæœŸåŒ–ä¸­
  isAuthenticated,   // èªè¨¼æ¸ˆã¿ã‹
  signInAnonymously, // åŒ¿åãƒ­ã‚°ã‚¤ãƒ³
  signOut,           // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
  linkWithGoogle,    // Googleé€£æº
  updateProfile,     // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–°
  refreshProfile,    // ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«å†å–å¾—
} = useAuth();
```

### ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | DBåˆ— | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
|-----------|------|---------------|
| displayName | `profiles.display_name` | å¿…é ˆã€1-20æ–‡å­— |
| nameKana | `profiles.name_kana` | å¿…é ˆã€ã²ã‚‰ãŒãª/ã‚«ã‚¿ã‚«ãƒŠ |
| grade | `profiles.grade` | å¿…é ˆã€'å°å­¦1å¹´'ã€œ'ä¸­å­¦3å¹´' |
| avatarUrl | `profiles.avatar_url` | ä»»æ„ã€5MBä»¥ä¸‹ |

---

## 7. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

### ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§

| # | ãƒ†ãƒ¼ãƒ–ãƒ« | ç”¨é€” | RLS |
|---|---------|------|-----|
| 1 | `profiles` | ãƒ¦ãƒ¼ã‚¶ãƒ¼æ‹¡å¼µ | âœ“ |
| 2 | `mentor_profiles` | ãƒ¡ãƒ³ã‚¿ãƒ¼å›ºæœ‰æƒ…å ± | âœ“ |
| 3 | `diary_posts` | å­¦ç¿’æ—¥å ± | âœ“ |
| 4 | `diary_reactions` | æ—¥å ±ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | âœ“ |
| 5 | `chat_rooms` | ãƒãƒ£ãƒƒãƒˆãƒ«ãƒ¼ãƒ  | âœ“ |
| 6 | `messages` | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | âœ“ |
| 7 | `message_reactions` | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ | âœ“ |
| 8 | `badge_definitions` | ãƒãƒƒã‚¸ãƒã‚¹ã‚¿ | âœ“ |
| 9 | `user_badges` | ç²å¾—ãƒãƒƒã‚¸ | âœ“ |
| 10 | `surveys` | ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ | âœ“ |
| 11 | `survey_responses` | å›ç­” | âœ“ |
| 12 | `notifications` | ãŠçŸ¥ã‚‰ã› | âœ“ |
| 13 | `user_notifications` | æ—¢èª­çŠ¶æ…‹ | âœ“ |

### ENUMå‹

| å‹ | å€¤ |
|-----|-----|
| `subject_type` | å›½èª, æ•°å­¦, ç†ç§‘, ç¤¾ä¼š, è‹±èª, ãã®ä»– |
| `reaction_emoji` | ğŸ‘, â¤ï¸, ğŸ‰, ğŸ‘, ğŸ”¥ |
| `message_type` | text, image |
| `badge_rank` | platinum, gold, silver, bronze |
| `survey_status` | draft, scheduled, active, closed |
| `notification_category` | info, event, important |

---

## 8. ãƒ•ãƒƒã‚¯ä¸€è¦§

### èªè¨¼

```typescript
import { useAuth } from '@/lib';
```

### ãƒ‡ãƒ¼ã‚¿å–å¾—

| ãƒ•ãƒƒã‚¯ | ç”¨é€” | ãƒ•ã‚¡ã‚¤ãƒ« |
|-------|------|---------|
| `useCurrentUser()` | ç¾åœ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾— | `useCurrentUser.ts` |
| `useDiaryPosts(options)` | æ—¥å ±ä¸€è¦§ï¼ˆç„¡é™ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰ | `useDiary.ts` |
| `useDiaryPost(id)` | æ—¥å ±è©³ç´° | `useDiary.ts` |
| `useCreateDiaryPost()` | æ—¥å ±ä½œæˆ | `useDiary.ts` |
| `useAddDiaryReaction()` | æ—¥å ±ãƒªã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ  | `useDiary.ts` |
| `useChatRooms(userId)` | ãƒãƒ£ãƒƒãƒˆãƒ«ãƒ¼ãƒ ä¸€è¦§ | `useChat.ts` |
| `useMessages(roomId)` | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§ | `useChat.ts` |
| `useRealtimeMessages(roomId)` | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è³¼èª­ | `useChat.ts` |
| `useSendMessage()` | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ | `useChat.ts` |
| `useNotifications(userId)` | é€šçŸ¥ä¸€è¦§ | `useNotifications.ts` |
| `useUnreadNotificationCount(userId)` | æœªèª­æ•° | `useNotifications.ts` |
| `useActiveSurveys()` | å›ç­”å¯èƒ½ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ | `useSurveys.ts` |
| `useSubmitSurveyResponse()` | å›ç­”é€ä¿¡ | `useSurveys.ts` |
| `useBadgesWithProgress(userId)` | ãƒãƒƒã‚¸ä¸€è¦§ï¼ˆé€²æ—ä»˜ãï¼‰ | `useBadges.ts` |
| `useCalendarData(userId, year, month)` | ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‡ãƒ¼ã‚¿ | `useCalendar.ts` |
| `useStreak(userId)` | é€£ç¶šæ—¥æ•° | `useBadges.ts` |

---

## 9. æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå„ªå…ˆåº¦é †ï¼‰

### P0: èªè¨¼é€£æºï¼ˆãƒ­ã‚°ã‚¤ãƒ³ãŒå‹•ä½œã—ãªã„ã¨ä»–ãŒä½•ã‚‚ã§ããªã„ï¼‰

#### 1. LoginPage.tsx ä¿®æ­£

```typescript
// frontend/src/features/auth/student/pages/LoginPage/LoginPage.tsx

import { useAuth } from '@/lib';
import { useNavigate } from 'react-router-dom';

const LoginPage = () => {
  const { signInAnonymously, isLoading } = useAuth();
  const navigate = useNavigate();

  const handleLogin = async () => {
    const { error } = await signInAnonymously();
    if (!error) {
      navigate('/');  // ãƒ›ãƒ¼ãƒ ã¸é·ç§»
    }
  };

  return (
    <button onClick={handleLogin} disabled={isLoading}>
      ãƒ­ã‚°ã‚¤ãƒ³
    </button>
  );
};
```

#### 2. RegisterPage.tsx ä¿®æ­£

```typescript
// frontend/src/features/auth/student/pages/RegisterPage/RegisterPage.tsx

import { useAuth } from '@/lib';

const RegisterPage = () => {
  const { updateProfile } = useAuth();

  const handleSubmit = async (formData: FormData) => {
    const { error } = await updateProfile({
      display_name: formData.displayName,
      name_kana: formData.nameKana,
      grade: formData.grade,
      avatar_url: formData.avatarUrl,
    });
    // æˆåŠŸæ™‚ã¯ãƒ›ãƒ¼ãƒ ã¸é·ç§»
  };
};
```

#### 3. ProtectedRoute.tsx æ–°è¦ä½œæˆ

```typescript
// frontend/src/shared/components/ProtectedRoute/ProtectedRoute.tsx

import { useAuth } from '@/lib';
import { Navigate } from 'react-router-dom';

export const ProtectedRoute = ({ children }: { children: React.ReactNode }) => {
  const { isAuthenticated, isLoading } = useAuth();

  if (isLoading) return <div>Loading...</div>;
  if (!isAuthenticated) return <Navigate to="/login" />;

  return <>{children}</>;
};
```

### P1: ãƒšãƒ¼ã‚¸åˆ¥çµ±åˆ

å„ãƒšãƒ¼ã‚¸ã§mockãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ãƒƒã‚¯å‘¼ã³å‡ºã—ã«ç½®æ›ã€‚ä¾‹ï¼š

```typescript
// DiaryPage.tsx
import { useDiaryPosts, useCreateDiaryPost } from '@/lib';

const DiaryPage = () => {
  const { data, isLoading, fetchNextPage } = useDiaryPosts();
  const createPost = useCreateDiaryPost();

  // mockData ã‚’ data?.pages.flatMap(p => p.data) ã«ç½®æ›
};
```

### P2: Supabaseã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

1. https://supabase.com ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
2. `.env.local` ã‚’ä½œæˆ:
   ```
   VITE_SUPABASE_URL=https://your-project.supabase.co
   VITE_SUPABASE_ANON_KEY=your-anon-key
   ```
3. Supabase CLI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: `npm install -g supabase`
4. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ: `supabase db push`

---

## 10. æ³¨æ„äº‹é …ãƒ»è½ã¨ã—ç©´

### å‹å®šç¾©ã®ä¸æ•´åˆ

| ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ | DB | æ³¨æ„ |
|---------------|-----|------|
| `displayName` | `display_name` | snake_caseå¤‰æ›å¿…è¦ |
| `nameKana` | `name_kana` | snake_caseå¤‰æ›å¿…è¦ |
| `isRead` | `is_read` | snake_caseå¤‰æ›å¿…è¦ |

### gradeå€¤ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

```typescript
// âœ… æ­£ã—ã„
grade: 'å°å­¦1å¹´' | 'å°å­¦2å¹´' | ... | 'ä¸­å­¦3å¹´'

// âŒ é–“é•ã„ï¼ˆä»¥å‰ã®ã‚³ãƒ¼ãƒ‰ã«ã‚ã£ãŸï¼‰
grade: 'å°1' | 'å°2' | ...
```

### Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰

`lib/supabase.ts` ã¯ç’°å¢ƒå¤‰æ•°æœªè¨­å®šæ™‚ã«ãƒ¢ãƒƒã‚¯ãƒ¢ãƒ¼ãƒ‰ã§å‹•ä½œï¼š
- é–‹ç™ºæ™‚ã«è­¦å‘ŠãŒå‡ºã‚‹ãŒæ­£å¸¸
- æœ¬ç•ªã¯å¿…ãšç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã“ã¨

### RLSãƒãƒªã‚·ãƒ¼

- å…¨ãƒ†ãƒ¼ãƒ–ãƒ«ã«RLSãŒæœ‰åŠ¹
- èªè¨¼ãªã—ã§ã¯ä½•ã‚‚CRUDã§ããªã„
- ãƒ†ã‚¹ãƒˆæ™‚ã¯èªè¨¼ã‚’å…ˆã«å®Ÿè£…ã™ã‚‹ã“ã¨

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½

- `useRealtimeMessages` / `useRealtimeNotifications` ã¯Effectå†…ã§subscribe
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆunmountæ™‚ã«cleanupãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã‚‹
- Supabase Realtimeã‚’æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ã‚ã‚Šï¼ˆDashboardè¨­å®šï¼‰

---

## 11. é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repo-url>
cd co_plus_study

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
cd frontend
npm install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•
npm run dev

# ãƒ“ãƒ«ãƒ‰ç¢ºèª
npm run build
```

### ç’°å¢ƒå¤‰æ•°

```bash
# frontend/.env.local ã‚’ä½œæˆ
cp .env.example .env.local

# ä»¥ä¸‹ã‚’è¨­å®š
VITE_SUPABASE_URL=https://xxx.supabase.co
VITE_SUPABASE_ANON_KEY=eyJxxx...
```

---

## 12. ã‚ˆãã‚ã‚‹è³ªå•

### Q: ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹
A: `npm run build` ã§TypeScriptã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹å ´åˆã€`lib/hooks/` å†…ã®å‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã€‚`as unknown as Record<string, unknown>` ãƒ‘ã‚¿ãƒ¼ãƒ³ã§è§£æ±ºæ¸ˆã¿ã®ã¯ãšã€‚

### Q: mockãƒ‡ãƒ¼ã‚¿ã¯ã©ã“ï¼Ÿ
A: `frontend/src/mockData/` ã¾ãŸã¯å„ `features/*/mockData/` ã«ã‚ã‚‹ã€‚ãƒ•ãƒƒã‚¯çµ±åˆæ™‚ã«ã“ã‚Œã‚‰ã®å‚ç…§ã‚’å‰Šé™¤ã€‚

### Q: ãƒãƒ£ãƒƒãƒˆã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãŒå‹•ã‹ãªã„
A: Supabase Dashboardã§Realtimeã‚’æœ‰åŠ¹åŒ–ã€‚Database â†’ Replication ã§ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æœ‰åŠ¹åŒ–ã€‚

### Q: ãƒãƒƒã‚¸ã®é€²æ—è¨ˆç®—ã¯ã©ã†ãªã£ã¦ã‚‹ï¼Ÿ
A: `useBadges.ts` ã® `calculateBadgeProgress()` ã§ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨ˆç®—ã€‚Edge FunctionåŒ–ã¯P3ã€‚

### Q: ãƒ¡ãƒ³ã‚¿ãƒ¼å‰²ã‚Šå½“ã¦ã¯ã©ã†ã™ã‚‹ï¼Ÿ
A: Phase 1ã§ã¯ç®¡ç†è€…ãŒæ‰‹å‹•ã§ `chat_rooms` ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã€‚è‡ªå‹•ãƒãƒƒãƒãƒ³ã‚°ã¯Phase 2ä»¥é™ã€‚

---

## é€£çµ¡å…ˆ

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ä¸æ˜ç‚¹ãŒã‚ã‚Œã°ã€ä»¥ä¸‹ã‚’å‚ç…§ï¼š
- ADR-005: `project/decisions/005-backend-integration-preparation.md`
- æ©Ÿèƒ½ä»•æ§˜: `specs/features/*.md`
- å‹å®šç¾©: `frontend/src/shared/types/*.ts`
