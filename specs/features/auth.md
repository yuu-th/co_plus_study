# 認証機能

> 最終更新: 2025-12-25
> ステータス: 部分実装（バックエンド連携待ち）

## 1. 概要

ユーザー認証とアカウント登録を管理する機能。生徒・メンターそれぞれにログイン/登録フローを提供する。

## 2. ユーザーストーリー

### 生徒向け

- 新規ユーザーとして、アカウント登録をしたい。アプリを使い始めたいから。
- 生徒として、ログインしたい。自分のデータにアクセスしたいから。
- 生徒として、ログアウトしたい。別のアカウントに切り替えたいから。

### メンター向け

- メンターとして、専用画面にログインしたい。生徒管理を行いたいから。

## 3. データ構造

> **SSoT**: `project/decisions/005-backend-integration-preparation.md`
>
> 関連テーブル: `auth.users`（Supabase管理）, `profiles`
> 型定義: `frontend/src/shared/types/user.ts`

### RegistrationFormData

| フィールド | バリデーション | 説明 |
|-----------|---------------|------|
| `displayName` | 必須、1-20文字 | 表示名 |
| `nameKana` | 必須、ひらがな/カタカナのみ | フリガナ |
| `grade` | 必須、選択肢から選択 | 学年（小1〜中3） |
| `avatarUrl` | 任意、5MB以下 | アバター画像URL |

### LoginCredentials

| フィールド | 説明 |
|-----------|------|
| `email` | メールアドレス |
| `password` | パスワード |

## 4. 認証方式（ADR-005参照）

### Phase 1（現在）

| 項目 | 内容 |
|------|------|
| 方式 | 匿名認証（デモ用） |
| 状態 | ログイン/登録UIのみ実装 |

### Phase 2（予定）

| 項目 | 内容 |
|------|------|
| 方式 | Supabase Auth + OAuth |
| 対応 | Google, GitHub等 |

## 5. CRUDフロー

### 生徒向け

| 操作 | 画面 | 説明 |
|------|------|------|
| **Create** | RegisterPage | アカウント新規登録 |
| **Read** | ログイン状態確認 | セッション確認 |
| **Update** | - | パスワード変更等（Phase 2） |

### メンター向け

| 操作 | 画面 | 説明 |
|------|------|------|
| **Read** | MentorLoginPage | メンターログイン |

## 6. ページ構成

### 生徒向け

| パス | ページ | 説明 |
|------|--------|------|
| `/login` | LoginPage | ログイン画面 |
| `/register` | RegisterPage | アカウント登録 |

### メンター向け

| パス | ページ | 説明 |
|------|--------|------|
| `/mentor/login` | MentorLoginPage | メンターログイン |

## 7. 画面仕様

### RegisterPage

- **ステップ形式**: 1画面完結
- **入力項目**: ユーザー名、フリガナ、学年
- **バリデーション**: リアルタイムエラー表示
- **送信ボタン**: 「登録する」

### LoginPage

- 現在簡易実装（「ログイン機能は実装中」メッセージ表示）
- Phase 2で本格実装予定

## 8. 関連

- → ADR-005（認証設計）
- → specs/features/home.md（ログイン後リダイレクト先）
- → specs/features/tutorial.md（初回登録後のチュートリアル）

## 9. 変更履歴

| 日付 | 変更内容 |
|------|----------|
| 2025-12-25 | 初版作成、既存実装に基づいて仕様化 |
